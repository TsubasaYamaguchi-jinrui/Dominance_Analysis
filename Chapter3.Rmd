# 3. Linearityの算出  
## 3.1 Linearityとは  
Linearityは**順位序列がどの程度直線的か**を示す指標である。直線的とは、順位序列に逆転や三すくみのような関係がないことを指す。linearityの指標としては$h'$がよく用いられる。０から1の値を取り、1に近づくほど直線性が高いことを示す。計算方法は少し複雑なので、以下を参照[@deVries1995]。    

## 3.2 Rを用いたlinearityの算出  
`compete`パッケージを用いて以下のように算出することができる。  
```{r}
mat <- matrix(c(0,58,50,61,32,37,29,39,25,8,0,22,22,9,27,20,10,48,
              3,3,0,19,29,12,13,19,8,5,8,9,0,33,38,35,32,57,
              4,7,9,1,0,28,26,16,23,4,3,0,0,6,0,7,6,12,
              2,0,4,1,4,4,0,5,3,0,2,1,1,5,8,3,0,10,3,1,3,0,0,4,1,2,0),
              nrow=9,byrow=TRUE)

individuals <- c("V","VS","B","FJ","PR","VB","TOR","MU","ZV") %>% 
  as.character()

##列名と行名を追加  
colnames(mat) <- individuals
rownames(mat) <- individuals

lin <- devries(mat, Nperms = 10000)

lin$`h-modified`
```

$h'$は0.9667なので、順位序列の直線性はかなり高いことが分かる。  
個体の勝敗がランダムに割り振られたときと比較して$h'$が有意に高いかも検定することができる。  
今回は、有意に高いことが示された。  
```{r}
lin$`p-value`
```